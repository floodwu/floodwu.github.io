# 机器代码实现C语言条件语句的原理

C语言中的某些结构，比如条件语句、循环语句、分支语句，要求有条件地执行。机器代码提供两种基本的低级机制来实现有条件的行为。除了整数寄存器，CPU还维护着一组单个位的`条件码寄存器`用于描述最近的算术或逻辑操作的结果。可以检测这些寄存器来执行条件分支指令。常用的条件码有：
CF:进位标志，最近的操作使最高位产生了进位，可以用来检查无符号操作数的溢出；
ZF:零标志，最近的操作得出的结果为0；
SF:符号标志，最近的操作得到的结果为负数；
OF:溢出标志，最近的操作导致一个补码溢出（正溢出或负溢出）

跳转指令会导致执行切换到程序中一个全新的位置，在汇编代码中，跳转的目的地通常用一个label表示。
如：
int absdiff(int x, int y){
	if(x < y){
		return y - x;
	}
	else{
		return x - y;
	}
} 
以上C语言代码将被编译为如下汇编代码：x在%ebp+8中，y在%ebp+12中

```
  movl 8(%ebp),%edx          获取x
  movl 12(%ebp),%eax         获取y
  cmpl %eax,%edx             比较x和y
  jge  .L2                   如果>=，则跳转.L2
  subl %edx,%eax             计算y-x
  jmp  .L3                   无条件跳转.L3
.L2:
  subl  %eax,%edx            计算x-y
  movl  %edx,%eax            两种情况下返回值都放在%eax中
.L3:                         结束
```

C语言中提供了多种循环结构，do-while、while、for等。可以使用条件测试和跳转组合起来实现循环的效果。大多数汇编器会根据一个循环的do-while形式来产生循环代码，其他的循环会首先转换成do-while形式，再编译成机器代码。