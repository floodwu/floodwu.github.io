# OSPF协议

## OSPF 协议的基本特点

“开放”表明 OSPF 协议不是受某一家厂商控制，而是公开发表的。
“最短路径优先”是因为使用了 Dijkstra 提出的最短路径算法SPF
OSPF 只是一个协议的名字，它并不表示其他的路由选择协议不是“最短路径优先”。
是分布式的链路状态协议。

## 三个要点 

向本自治系统中所有路由器发送信息，这里使用的方法是洪泛法。
发送的信息就是与本路由器相邻的所有路由器的链路状态，但这只是路由器所知道的部分信息。
`“链路状态”`就是说明本路由器都和哪些路由器相邻，以及该链路的“度量”(metric)。 
只有当链路状态发生变化时，路由器才用洪泛法向所有路由器发送此信息。  

## 链路状态数据库

由于各路由器之间频繁地交换链路状态信息，因此所有的路由器最终都能建立一个链路状态数据库。
这个数据库实际上就是`全网的拓扑结构图`，它在全网范围内是一致的（这称为链路状态数据库的同步）。
OSPF 的链路状态数据库能较快地进行更新，使各个路由器能及时更新其路由表。OSPF 的更新过程收敛得快是其重要优点。  

## OSPF 直接用 IP 数据报传送 

`OSPF 不用 UDP 而是直接用 IP 数据报传送`。
OSPF 构成的数据报很短。这样做可减少路由信息的通信量。
数据报很短的另一好处是可以不必将长的数据报分片传送。分片传送的数据报只要丢失一个，就无法组装成原来的数据报，而整个数据报就必须重传。

## OSPF 的其他特点 

1.OSPF 对不同的链路可根据 IP 分组的不同服务类型 TOS 而设置成不同的代价。因此，OSPF 对于不同类型的业务可计算出不同的路由。
2.如果到同一个目的网络有多条相同代价的路径，那么可以将通信量分配给这几条路径。这叫作多路径间的负载平衡。
3.所有在 OSPF 路由器之间交换的分组都具有鉴别的功能。
4.支持可变长度的子网划分和无分类编址 CIDR。
5.每一个链路状态都带上一个 32 位的序号，序号越大状态就越新。

## OSPF 分组 

![image](https://github.com/woojean/woojean.github.io/blob/master/images/wangluo10.png)

## OSPF 的五种分组类型 

类型1，问候(Hello)分组。
类型2，数据库描述(Database Description)分组。
类型3，链路状态请求(Link State Request)分组。
类型4，链路状态更新(Link State Update)分组，用洪泛法对全网更新链路状态。
类型5，链路状态确认(Link State Acknowledgment)分组。

## OSPF 的其他特点 

1.OSPF 还规定每隔一段时间，如 30 分钟，要刷新一次数据库中的链路状态。 
2.由于一个路由器的链路状态只涉及到与相邻路由器的连通状态，因而与整个互联网的规模并无直接关系。因此当互联网规模很大时，OSPF 协议要比距离向量协议 RIP 好得多。 
3.OSPF 没有“坏消息传播得慢”的问题，据统计，其响应网络变化的时间小于 100 ms。