# RIP协议

RIP 是一种分布式的`基于距离向量`的路由选择协议。
RIP 协议要求网络中的每一个路由器都要维护从它自己到其他每一个目的网络的距离记录。

## “距离”的定义 

从一路由器到直接连接的网络的距离定义为 1。
从一个路由器到非直接连接的网络的距离定义为所经过的路由器数加 1。
RIP 协议中的“距离”也称为“跳数”(hop count)，因为每经过一个路由器，跳数就加 1。
这里的“距离”实际上指的是“最短距离”，
RIP 认为一个好的路由就是它通过的路由器的数目少，即“距离短”。
RIP 允许`一条路径最多只能包含 15 个路由器`。
“距离”的最大值为16 时即相当于不可达。可见 RIP 只适用于小型互联网。
RIP 不能在两个网络之间同时使用多条路由。RIP 选择一个具有最少路由器的路由（即最短路由），哪怕还存在另一条高速(低时延)但路由器较多的路由。   

## RIP 协议的三个要点 

1.仅和相邻路由器交换信息。 
2.交换的信息是当前本路由器所知道的全部信息，即自己的路由表。 
3.按固定的时间间隔交换路由信息，例如，每隔 30 秒。

## 距离向量算法

收到相邻路由器（其地址为 X）的一个 RIP 报文：
(1) 先修改此 RIP 报文中的所有项目：把“下一跳”字段中的地址都改为 X，并把所有的“距离”字段的值加 1。
(2) 对修改后的 RIP 报文中的每一个项目，重复以下步骤：
若项目中的目的网络不在路由表中，则把该项目加到路由表中。
否则若下一跳字段给出的路由器地址是同样的，则把收到的项	目	替换原路由表中的项目。
否则若收到项目中的距离小于路由表中的距离，则进行更新，
否则，什么也不做。
(3) 若 3 分钟还没有收到相邻路由器的更新路由表，则把此相邻路由器记为不可达路由器，即将距离置为16（距离为16表示不可达）。
(4) 返回。

## RIP2 协议的报文格式 

![image](https://github.com/woojean/woojean.github.io/blob/master/images/wangluo9.png)

RIP2 报文中的路由部分由若干个路由信息组成。每个路由信息需要用 20 个字节。地址族标识符（又称为地址类别）字段用来标志所使用的地址协议。
路由标记填入自治系统的号码，这是考虑使RIP 有可能收到本自治系统以外的路由选择信息。再后面指出某个网络地址、该网络的子网掩码、下一跳路由器地址以及到此网络的距离。  

##RIP 协议的优缺点 
RIP 存在的一个问题是当网络出现故障时，要经过比较长的时间才能将此信息传送到所有的路由器。（`好消息传播得快，而坏消息传播得慢`）
RIP 协议最大的优点就是实现简单，开销较小。
RIP `限制了网络的规模`，它能使用的最大距离为 15（16 表示不可达）。
路由器之间交换的路由信息是路由器中的完整路由表，因而随着网络规模的扩大，开销也就增加。   