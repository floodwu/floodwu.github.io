# 创建窗口的过程

从 WmS的角度来看，一个窗口并不是Window类，而是一个View类。WmS收到用户消息后，需要把消息派发到窗口（View），View类本身并不能直接接收WmS传递过来的消息，真正接收用户消息的必须是IWindow类，而实现IWindow类的是ViewRoot.W类，每一个W 内部都包含了一个View变量。WmS并不关心该窗口（View)是属于哪个应用程序的，WmS会按一定的规则判断哪个窗口处于活动状态，然后把用户消息给W类，W类再把用户消息传递给内部的View变量，剩下的消息处理就由View对象完成。

窗口类型
Framework定义了三种窗口类型，三种类型的定义在WindowManager类中。
1）应用窗口。该窗口对应一个Activity，由于加载Activity是由AmS完成的，因此，对于应用程序来讲，要创建一个应用类窗口，只能在 Activity内部完成。
2）子窗口。该窗口必须有一个父窗口，父窗口可以是一个应用类型窗口，也可以是任何其他类型的窗口。
3）系统窗口。系统窗口不需要对应任何Activity，也不需要有父窗口。对于应用程序而言，理论上是无法创建系统窗口的，因为所有的应用程序都没有这个权限，然而系统进程却可以创建系统窗口。
WindowManager类对这三种类型进行了细化，把每一种类型都用一个int常量表示，这些实际上代表了窗口对应的层（Layer)。WmS在进行窗口叠加时，会按照该int常量的大小分配不同层，int值越大，代表层的位置越靠上面，即所谓的z-order。层值在WmS进行窗口叠加时会动态改变。应用型窗口的层值为1~99，子窗口的层值为1000~1999，系统窗口的层值为2000~2999。