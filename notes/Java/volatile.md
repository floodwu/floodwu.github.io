# volatile

`原子操作`是不能被线程调度机制中断的操作（会在切换到其他线程之前执行完毕）。

原子性可以应用于除long、double之外的所有基本数据类型之上的简单操作。JVM会将64位（long、double）的读取和写入当做两个分离的32位操作来执行，在这个过程中可能发生上下文切换。可以使用volatile关键字来避免这种情况。

在多处理器系统中可视性问题也很常见：一个任务做出的修改，即使在不中断的意义上是原子性的，对其他任务也可能是不可视的，比如修改只是暂时性地存储在本地的处理器缓存中。如果将一个域声明为volatile，那么只要对这个域产生了写操作，其值就会立即被写入到主存中。

如果多个任务在同时访问某个域，那么这个域应该是volatile的，否则这个域应该只能通过同步访问（同步必然导致向主存中刷新，因此如果一个域完全由synchronized方法或语句块来防护，就不必设置它为volatile）。

一个任务所作的任何写入操作对这个任务来说都是可视的，因此如果某个域只需要在这个任务内部可视，那么就无需将其设置为volatile。