# 对象数据流

如果想在对象流中保存和恢复任何一个类，则该类必须实现Serializable接口。Serializable接口没有方法。对象序列化机制使得可以如同存储文本或者数据字段一样简单地存储对象。
保存对象数据需要使用ObjectOutputStream，如：

```java
ObjectOutputStream out=new ObjectOutputStream(new FileOutputStream(“employee.dat”));
Employee harry=…;
Manager boss=…;
out.writeObject(harry);
out.writeObject(boss);
```
读回对象需要使用ObjectInputStream对象，如：
```java
ObjectInputStream in=new ObjectInputStream(new FileInputStream(“employee.dat”));
Employee e1=(Employee)in.readObject();
Employee e2=(Employee)in.readObject();
```
读回对象时必须对已保存对象的数量，它们的顺序以及它们的类型做到心中有数。

因为当一个对象被重新装载后，它可能占据一个和原来那个截然不同的内存地址，所以对于对象内部的对象引用，不能保存和恢复它们的内存地址。为此，Java采用“序列化”方式，具体算法为：
1）保存到磁盘的所有对象都获得一个序列号；
2）当要保存一个对象时，先检查该对象是否已经被保存；
3）如果以前保存过，只需写入“与已保存的具有序列号x的对象相同”标记；否则，保存它的所有数据；
当要读回对象时，将上述过程简单地逆转即可。对于载入的每个对象，都要注意它的序列号，并记住它在内存中的位置。如果遇到与已经保存的具有序列号x的对象相同标记，就根据序列号来获取该对象的位置，并设置对象引用，令其指向那个内存地址。
当使用对象流时，这些过程都会自动完成，对象流会分配序列号，并跟踪重复的对象。