# 修饰器

修饰器（Decorator）是一个函数，用来修改类的行为。这是ES7的一个提案。修饰器对类的行为的改变，是代码编译时发生的，而不是在运行时。这意味着，修饰器能在编译阶段运行代码：

```
function testable(target) {
  target.isTestable = true;
}

@testable
class MyTestableClass {}

console.log(MyTestableClass.isTestable) // true
```
修饰器本质就是编译时执行的函数。修饰器函数的第一个参数，就是所要修饰的目标类。


可以在修饰器外面再封装一层函数来为修饰器增加参数：
```
function testable(isTestable) {
  return function(target) {
    target.isTestable = isTestable;
  }
}

@testable(true)
class MyTestableClass {}
MyTestableClass.isTestable // true

@testable(false)
class MyClass {}
MyClass.isTestable // false
```

## 方法的修饰

修饰器函数一共可以接受三个参数，第一个参数是所要修饰的目标对象，第二个参数是所要修饰的属性名，第三个参数是该属性的描述对象。
```
class Person {
  @nonenumerable
  get kidCount() { return this.children.length; }
}

function nonenumerable(target, name, descriptor) {
  descriptor.enumerable = false;
  return descriptor;
}
```

## 为什么修饰器不能用于函数？
修饰器只能用于类和类的方法，不能用于函数，因为存在函数提升。
```
var counter = 0;

var add = function () {
  counter++;
};

@add
function foo() {
}
```
因为函数提升，使得实际执行的代码是下面这样：
```
var counter;
var add;

@add
function foo() {
}

counter = 0;

add = function () {
  counter++;
};
```