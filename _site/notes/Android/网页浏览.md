# 网页浏览

使用浏览器应用：

```java
Uri photoPageUri = Uri.parse(item.getPhotoPageUrl());
Intent i = new Intent(Intent.ACTION_VIEW,photoPageUri);  // 隐式Intent
startActivity(i);
```
使用WebView:
定义一个包含WebView的Fragment：
```java
public class PhotoPageFragment extends VisibleFragment{
private String mUrl;
private WebView mWebView;

@Override
public void onCreate(Bundle savedInstanceState){
		super.onCreate(savedInstanceState);
setRetainInstance(true);

mUrl = getActivity().getIntent().getData().toString();
}

@SuppressLint(“SetJavaScriptEnabled”)
@Override
public View onCreateView(LayoutInflater inflater,ViewGroup parent,Bundle savedInstanceState){
View v = inflater.inflate(R.layout.fragment_photo_page,parent,false);
mWebView = (WebView)v.findViewById(R.id.webView);

mWebView.getSettings().setJavaScriptEnabled(true);  // 启用Javascript

// WebViewClient是响应渲染事件的接口，WebChromeClient是响应那些改变浏览器中装饰元素的事件接口
mWebView.setWebViewClient(new WebViewClient(){
// shouldOverrideUrlLoading(...)方法用于处理当前WebView中存在链接的情况
如果WebView根本没有设置WebViewClient，则在WebView中点击url时，会弹出可选应用的列表。如果设置了WebViewClient，则当该方法返回true时，表示点击链接后将离开当前WebView，由应用来处理接下来的步骤。如果返回false，则表示点击链接后仍然在该WebView中打开新链接。
public boolean shouldOverrideUrlLoading(WebView view,String url){
return false;
}
}

final ProgressBar progressBar = (ProgressBar)v.findViewById(R.id.progressBar);
progressBar.setMax(100);
final TextView titleTextView = (TextView)v.findViewById(R.id.titleTextView);
mWebView.setWebChromeClient(new WebChromeClient(){
public void onProgressChanged(WebView webView,int progress){
if(progress == 100){
progressBar.setVisibility(view.INVISIBLE);
}
else{
progressBar.setVisibility(View.VISIBLE);
pregressBar.setProgress(progress);
}
}

public void onReceivedTitle(WebView webView,String title){
titleTextView.setText(title);
}
}

mWebView.loadUrl(mUrl);
return v;
}
}
```
创建托管该Fragement的Activity：
```java
public class PhotoPageActivity extends SingleFragmentActivity{
@Override
public Fragment createFragment(){
return new PhotoPageFragment();
}
}
```
之后，在其他地方启动该Activity：
```java
Intent i = new Intent(getActivity(),PhotoPageActivity.class);
i.setData(photoPageUri);
startActivity(i);
```
解决旋转问题：
当设备旋转时，WebView必须重新加载网页，因为WebView包含了太多的数据，以至于无法在onSaveInstanceState(...)方法内保存所有数据。因此每次设备旋转，它都必须重头开始加载网页数据。可以通过设置android:configChanges属性来通知Activity自己处理设备配置调整，即无需销毁重建activity，可直接调整自己的视图已适应新的屏幕尺寸。
<activity 
android:name=”.PhotoPageActivity”
android:configChanges=”keyboardHidden|orientation|screenSize” />
...
默认情况下，当设备配置发生变更时，activity会销毁并重建。设置了configChanges属性后，当设备配置发生变更时，不会销毁activity，而是会调用其onConfigurationChanged()方法。