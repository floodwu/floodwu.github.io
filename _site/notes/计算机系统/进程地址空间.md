# 进程地址空间

内核除了管理本身的内存外，还必须管理用户空间中进程的内存，这个内存即进程地址空间。
Linux采用虚拟内存技术，系统中的所有进程之间以虚拟方式共享内存，对一个进程而言它好像可以访问整个系统的所有物理内存。

## 地址空间
进程可寻址的虚拟内存组成了进程的地址空间，内核允许进程使用这种虚拟内存中的地址。

## 平坦地址空间
每个进程都有一个32位或者64位的平坦（flat）地址空间，具体大小取决于体系结构。平坦指地址空间范围是一个独立的连续空间，如0~4294967295（2^32）。因为每个内存都有唯一的平坦地址空间，所以一个进程的地址空间与另一个进程的地址空间即使有相同的内存地址，实际上也彼此互不相干。

## 内存区域
尽管一个进程可以寻址4GB的虚拟内存，但这并不代表它有权访问所有的虚拟地址。可被访问的合法地址空间称为内存区域（memory areas），通过内核，进程可以给自己的地址空间动态地添加或减少内存区域。进程只能访问有效内存区域内的内存地址，每个内存区域也具有相关权限属性（可读、可写、可执行）。如果一个进程访问了不在有效范围内的内存地址，或者以不正确的方式访问了有效地址，那么内核就会终止该进程，并返回段错误信息。

## 内存区域可以包含进程的各种内存对象
如：
代码段：可执行文件代码的内存映射；
数据段：可执行文件的已初始化全局变量的内存映射；
BSS段：未初始化全局变量的内存映射，页面中的信息全部为0；
进程的用户空间栈（不同于进程内核栈）；
共享库（C库、动态链接库等）的代码段、数据段、bss段；
任何内存映射文件；
任何共享内存段；
任何匿名的内存映射，比如通过malloc()分配的内存；