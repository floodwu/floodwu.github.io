# 存在主键冲突时就更新

ON DUPLICATE KEY UPDATE语句的作用是什么？

```
INSERT INTO ... ON DUPLICATE KEY UPDATE col=VALUES(col)		# VALUES用来取插入的值，存在主键冲突时就更新，没有删除操作
```

例：更新统计表
老做法是写三条sql语句:
```
select * from player_count where player_id = 1;					# 查询统计表中是否有记录
insert into player_count(player_id,count) value(1,1);				# 没有记录就执行insert 操作
update player_count set count = count+1 where player_id = 1;		# 有记录就执行update操作
```
这种写法比较麻烦，用on duplicate key update 的做法如下：
```
insert into player_count(player_id,count) value(1,1) on duplicate key update count=count+1;
```